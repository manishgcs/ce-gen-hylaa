% Plot reachable region (Code generated by Hylaa using PLOT_MATLAB)
h = figure(1);
set(h, 'Position', [200 200 800 600]);
hold on;

% data
reachSet = [
    {'loc1', [0.6666666666666666 1.0 0.6666666666666666], [0.0 1.0 0.0], 0, {
    [-1.07, -0.4;-1.07, -0.8;-1.0, -0.8;-1.0, -0.4;-1.07, -0.4;]
    [-0.9656680585179904, -0.17852012495074557;-0.9656680585179904, -0.5355459078695267;-0.9005308958112059, -0.5355459078695267;-0.9005308958112059, -0.10001446698271008;-0.9656680585179904, -0.10001446698271008;-0.9656680585179904, -0.17852012495074557;]
    [-0.8685839635490137, 0.25142814455507057;-0.8685839635490137, -0.0009179654595053988;-0.8079718211848692, -0.0009179654595053988;-0.8079718211848692, 0.25142814455507057;-0.8685839635490137, 0.25142814455507057;]
    [-0.7782442136885115, 0.47587795567854524;-0.7782442136885115, 0.3033264771710597;-0.7218427425573679, 0.3033264771710597;-0.7218427425573679, 0.6884543172506774;-0.7782442136885115, 0.6884543172506774;-0.7782442136885115, 0.47587795567854524;]
    [-0.6941802853234582, 0.8017599520728751;-0.6941802853234582, 0.43190523188973773;-0.6416969738667252, 0.43190523188973773;-0.6416969738667252, 0.8017599520728751;-0.6941802853234582, 0.8017599520728751;]
    [-0.6159562027565162, 0.5360655510092118;-0.6159562027565162, 0.2640900903905632;-0.5671188599315438, 0.2640900903905632;-0.5671188599315438, 0.6352828778774342;-0.6159562027565162, 0.6352828778774342;-0.6159562027565162, 0.5360655510092118;]
    [-0.5431662771314898, 0.23399246300799773;-0.5431662771314898, -0.029968673447229116;-0.49772162076352927, -0.029968673447229116;-0.49772162076352927, 0.23399246300799773;-0.5431662771314898, 0.23399246300799773;]
    [-0.4754330024336028, -0.2208704258023919;-0.4754330024336028, -0.38335706789684676;-0.43314534563369217, -0.38335706789684676;-0.43314534563369217, -0.09363904391265215;-0.4754330024336028, -0.09363904391265215;-0.4754330024336028, -0.2208704258023919;]
    [-0.4124050976527517, -0.24079118695866158;-0.4124050976527517, -0.5669136710443208;-0.373055126488974, -0.5669136710443208;-0.373055126488974, -0.24079118695866158;-0.4124050976527517, -0.24079118695866158;]
    [-0.35375568495592286, -0.2282943583613877;-0.35375568495592286, -0.479010712835392;-0.3171393210387477, -0.479010712835392;-0.3171393210387477, -0.17548819531410179;-0.35375568495592286, -0.17548819531410179;-0.35375568495592286, -0.2282943583613877;]
    [-0.2991805944203416, 0.060486759917195945;-0.2991805944203416, -0.19537675223060616;-0.26510793650314357, -0.19537675223060616;-0.26510793650314357, 0.060486759917195945;-0.2991805944203416, 0.060486759917195945;]
    [-0.24839678653528965, 0.2739539984531387;-0.24839678653528965, 0.1284623036125846;-0.2166911256409305, 0.1284623036125846;-0.2166911256409305, 0.33383312282932887;-0.24839678653528965, 0.33383312282932887;-0.24839678653528965, 0.2739539984531387;]
    [-0.201140884291308, 0.5551360024517342;-0.201140884291308, 0.2795408969911906;-0.17163778725699363, 0.2795408969911906;-0.17163778725699363, 0.5551360024517342;-0.201140884291308, 0.5551360024517342;]
    [-0.15716780724384893, 0.5102624614154865;-0.15716780724384893, 0.28976630977777074;-0.12971426393130348, 0.28976630977777074;-0.12971426393130348, 0.5274475682076785;-0.15716780724384893, 0.5274475682076785;-0.15716780724384893, 0.5102624614154865;]
    [-0.1162495004673017, 0.34330834335310284;-0.1162495004673017, 0.10879849705117489;-0.09070313021548704, 0.10879849705117489;-0.09070313021548704, 0.34330834335310284;-0.1162495004673017, 0.34330834335310284;]
    [-0.07817375180744346, 0.032777628213224004;-0.07817375180744346, -0.09192724466339683;-0.05440206501229761, -0.09192724466339683;-0.05440206501229761, 0.04199147359117688;-0.07817375180744346, 0.04199147359117688;-0.07817375180744346, 0.032777628213224004;]
    [-0.042743091298303226, -0.10255375433178703;-0.042743091298303226, -0.32598189204215394;-0.020622802289872733, -0.32598189204215394;-0.020622802289872733, -0.10255375433178703;-0.042743091298303226, -0.10255375433178703;]
    [-0.009773767035550274, -0.1561243094073472;-0.009773767035550274, -0.3507247716524682;0.010809845311067323, -0.3507247716524682;0.010809845311067323, -0.1561243094073472;-0.009773767035550274, -0.1561243094073472;]
    [0.020905207804959414, -0.10002417028434862;0.020905207804959414, -0.23858095724767484;0.040058895040888054, -0.23858095724767484;0.040058895040888054, -0.033362578343508864;0.020905207804959414, -0.033362578343508864;0.020905207804959414, -0.10002417028434862;]
    [0.049452941745868284, 0.13107716215085166;0.049452941745868284, 0.0018291399566032485;0.06727603948760463, 0.0018291399566032485;0.06727603948760463, 0.13107716215085166;0.049452941745868284, 0.13107716215085166;]
    [0.07601749018328219, 0.24421245178786657;0.07601749018328219, 0.15964407409857825;0.09260243329103082, 0.15964407409857825;0.09260243329103082, 0.3329631956181097;0.07601749018328219, 0.3329631956181097;0.07601749018328219, 0.24421245178786657;]
    }}
];

smt_lce = [-1.0, -0.781382965;
    -0.9005308958112059, -0.3655715446474247;
    -0.8079718211848692, 0.22322173316607452;
    -0.7218427425573679, 0.6785604633417748;
    -0.6416969738667252, 0.7864644807241252;
    -0.5671188599315438, 0.5234071093355155;
    -0.49772162076352927, 0.05157257241715045;
    -0.43314534563369217, -0.3774353901724976;
    -0.373055126488974, -0.5548743667803383;
    -0.3171393210387477, -0.4145355619223188;
    -0.26510793650314357, -0.05326017699072297;
    -0.2166911256409305, 0.3310461934436266;
    -0.17163778725699363, 0.5461073857382389;
    -0.12971426393130348, 0.49999999998447475;
    -0.09070313021548704, 0.23803313184643496;
    -0.05440206501229761, -0.09149840845868198;
    -0.020622802289872733, -0.3196079105287468;
    0.010809845311067323, -0.3420734899247289;
    0.040058895040888054, -0.16547057392587564;
    0.06727603948760463, 0.10562019353915345;
    0.09260243329103082, 0.32883250635770056;];

% data
milp_lce = [-1.0, -0.8;
    -0.9005308958112059, -0.45704024990149117;
    -0.8079718211848692, 0.11046344231781466;
    -0.7218427425573679, 0.6021785779969346;
    -0.6416969738667252, 0.7811495344885295;
    -0.5671188599315438, 0.585674214443323;
    -0.49772162076352927, 0.14477271702339117;
    -0.43314534563369217, -0.30211374684961934;
    -0.373055126488974, -0.53318885946942;
    -0.3171393210387477, -0.4526076313117491;
    -0.26510793650314357, -0.12709471696052702;
    -0.2166911256409305, 0.26108727540905174;
    -0.17163778725699363, 0.5143315177744086;
    -0.12971426393130348, 0.5188550148115825;
    -0.09070313021548704, 0.29382500239394443;
    -0.05440206501229761, -0.02957480822508641;
    -0.020622802289872733, -0.28274254554106315;
    0.010809845311067323, -0.34636395572399487;
    0.040058895040888054, -0.20525016127725496;
    0.06727603948760463, 0.05310333160822694;
    0.09260243329103082, 0.2906790067734656;];

tmp_sim = [-1.0, -0.4;
    -0.9005308958112059, -0.17852012495074557;
    -0.8079718211848692, 0.14004673677775054;
    -0.7218427425573679, 0.38960221642480247;
    -0.6416969738667252, 0.4525156494740834;
    -0.5671188599315438, 0.3136987538246744;
    -0.49772162076352927, 0.05925107253737742;
    -0.43314534563369217, -0.17488236495987955;
    -0.373055126488974, -0.2745159985335624;
    -0.3171393210387477, -0.20189127683774474;
    -0.26510793650314357, -0.007795275352883185;
    -0.2166911256409305, 0.2012081510328617;
    -0.17163778725699363, 0.32034538166851634;
    -0.12971426393130348, 0.29835886317386673;
    -0.09070313021548704, 0.1582818380103333;
    -0.05440206501229761, -0.020360962847133533;
    -0.020622802289872733, -0.14579310083287778;
    0.010809845311067323, -0.1604851253358205;
    0.040058895040888054, -0.06669337431392874;
    0.06727603948760463, 0.07980297049922798;
    0.09260243329103082, 0.20192826294322241;];

% plot all
for i = 1:size(reachSet,1)
    face_color = reachSet{i,2};
    edge_color = reachSet{i,3};
    poly_list = reachSet{i,5};

    for p_index = 1:size(poly_list,1)
        pts = poly_list{p_index};
        h = fill(pts(:,1), pts(:,2), face_color, 'EdgeColor', 'k', 'LineWidth', 1.5);
	plotnames(1) = h;
	legendnames{1} = 'Reachable set';

        reachSet{i,4} = h;  % add handle to reachSet data structure for use in legend
    end
end

% optional legend
%if (size(reachSet,1) > 1 && size(reachSet,1) < 10)
%    legend([reachSet{:,3}], reachSet{:,1})
%end

plotnames(2) = plot(smt_lce(:, 1), smt_lce(:, 2), 'm-*', 'LineWidth', 2);

legendnames{2} = 'Longest counterexample';

legend(plotnames, legendnames);
set(legend, 'fontsize', 15);
xlim([-1.1 0.1]);
ylim([-0.8 0.85]);
%legend(ca, 'Location', 'eastoutside');

% labels and such
xlabel('Z', 'FontSize', 24, 'FontName', 'Serif', 'Interpreter','LaTex');
ylabel('Y', 'FontSize', 24, 'FontName', 'Serif', 'Interpreter','LaTex');
%title('Damped Oscillator', 'FontSize', 32, 'FontName', 'Serif', 'Interpreter','LaTex');
hold off;
