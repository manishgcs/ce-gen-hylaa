% Plot reachable region (Code generated by Hylaa using PLOT_MATLAB)
h = figure(1);
set(h, 'Position', [200 200 800 600]);
hold on;

% data
reachSet = [
    {'loc1', [0.6666666666666666 1.0 0.6666666666666666], [0.0 1.0 0.0], 0, {
    [-1.07, -0.4;-1.07, -0.8;-1.0, -0.8;-1.0, -0.4;-1.07, -0.4;]
    [-0.9656680585179904, -0.17852012495074557;-0.9656680585179904, -0.5355459078695267;-0.9005308958112059, -0.5355459078695267;-0.9005308958112059, -0.10001446698271008;-0.9656680585179904, -0.10001446698271008;-0.9656680585179904, -0.17852012495074557;]
    [-0.8685839635490137, 0.25142814455507057;-0.8685839635490137, -0.0009179654595053988;-0.8079718211848692, -0.0009179654595053988;-0.8079718211848692, 0.25142814455507057;-0.8685839635490137, 0.25142814455507057;]
    [-0.7782442136885115, 0.47587795567854524;-0.7782442136885115, 0.3033264771710597;-0.7218427425573679, 0.3033264771710597;-0.7218427425573679, 0.6884543172506774;-0.7782442136885115, 0.6884543172506774;-0.7782442136885115, 0.47587795567854524;]
    [-0.6941802853234582, 0.8017599520728751;-0.6941802853234582, 0.43190523188973773;-0.6416969738667252, 0.43190523188973773;-0.6416969738667252, 0.8017599520728751;-0.6941802853234582, 0.8017599520728751;]
    [-0.6159562027565162, 0.5360655510092118;-0.6159562027565162, 0.2640900903905632;-0.5671188599315438, 0.2640900903905632;-0.5671188599315438, 0.6352828778774342;-0.6159562027565162, 0.6352828778774342;-0.6159562027565162, 0.5360655510092118;]
    [-0.5431662771314898, 0.23399246300799773;-0.5431662771314898, -0.029968673447229116;-0.49772162076352927, -0.029968673447229116;-0.49772162076352927, 0.23399246300799773;-0.5431662771314898, 0.23399246300799773;]
    [-0.4754330024336028, -0.2208704258023919;-0.4754330024336028, -0.38335706789684676;-0.43314534563369217, -0.38335706789684676;-0.43314534563369217, -0.09363904391265215;-0.4754330024336028, -0.09363904391265215;-0.4754330024336028, -0.2208704258023919;]
    [-0.4124050976527517, -0.24079118695866158;-0.4124050976527517, -0.5669136710443208;-0.373055126488974, -0.5669136710443208;-0.373055126488974, -0.24079118695866158;-0.4124050976527517, -0.24079118695866158;]
    [-0.35375568495592286, -0.2282943583613877;-0.35375568495592286, -0.479010712835392;-0.3171393210387477, -0.479010712835392;-0.3171393210387477, -0.17548819531410179;-0.35375568495592286, -0.17548819531410179;-0.35375568495592286, -0.2282943583613877;]
    [-0.2991805944203416, 0.060486759917195945;-0.2991805944203416, -0.19537675223060616;-0.26510793650314357, -0.19537675223060616;-0.26510793650314357, 0.060486759917195945;-0.2991805944203416, 0.060486759917195945;]
    [-0.24839678653528965, 0.2739539984531387;-0.24839678653528965, 0.1284623036125846;-0.2166911256409305, 0.1284623036125846;-0.2166911256409305, 0.33383312282932887;-0.24839678653528965, 0.33383312282932887;-0.24839678653528965, 0.2739539984531387;]
    [-0.201140884291308, 0.5551360024517342;-0.201140884291308, 0.2795408969911906;-0.17163778725699363, 0.2795408969911906;-0.17163778725699363, 0.5551360024517342;-0.201140884291308, 0.5551360024517342;]
    [-0.15716780724384893, 0.5102624614154865;-0.15716780724384893, 0.28976630977777074;-0.12971426393130348, 0.28976630977777074;-0.12971426393130348, 0.5274475682076785;-0.15716780724384893, 0.5274475682076785;-0.15716780724384893, 0.5102624614154865;]
    [-0.1162495004673017, 0.34330834335310284;-0.1162495004673017, 0.10879849705117489;-0.09070313021548704, 0.10879849705117489;-0.09070313021548704, 0.34330834335310284;-0.1162495004673017, 0.34330834335310284;]
    [-0.07817375180744346, 0.032777628213224004;-0.07817375180744346, -0.09192724466339683;-0.05440206501229761, -0.09192724466339683;-0.05440206501229761, 0.04199147359117688;-0.07817375180744346, 0.04199147359117688;-0.07817375180744346, 0.032777628213224004;]
    %[-0.042743091298303226, -0.10255375433178703;-0.042743091298303226, -0.32598189204215394;-0.020622802289872733, -0.32598189204215394;-0.020622802289872733, -0.10255375433178703;-0.042743091298303226, -0.10255375433178703;]
    %[-0.009773767035550274, -0.1561243094073472;-0.009773767035550274, -0.3507247716524682;0.010809845311067323, -0.3507247716524682;0.010809845311067323, -0.1561243094073472;-0.009773767035550274, -0.1561243094073472;]
    %[0.020905207804959414, -0.10002417028434862;0.020905207804959414, -0.23858095724767484;0.040058895040888054, -0.23858095724767484;0.040058895040888054, -0.033362578343508864;0.020905207804959414, -0.033362578343508864;0.020905207804959414, -0.10002417028434862;]
    %[0.049452941745868284, 0.13107716215085166;0.049452941745868284, 0.0018291399566032485;0.06727603948760463, 0.0018291399566032485;0.06727603948760463, 0.13107716215085166;0.049452941745868284, 0.13107716215085166;]
    %[0.07601749018328219, 0.24421245178786657;0.07601749018328219, 0.15964407409857825;0.09260243329103082, 0.15964407409857825;0.09260243329103082, 0.3329631956181097;0.07601749018328219, 0.3329631956181097;0.07601749018328219, 0.24421245178786657;]
    }}
];

sim_2 = [-1.0, -0.719;
    -0.9005308958112059, -0.35243745060659126;
    -0.8079718211848692, 0.1848422438212262;
    -0.7218427425573679, 0.6121051686803758;
    -0.6416969738667252, 0.7272559691698923;
    -0.5671188599315438, 0.5001394643195023;
    -0.49772162076352927, 0.07267365998042495;
    -0.43314534563369217, -0.32623279113994463;
    -0.373055126488974, -0.5015146394368979;
    -0.3171393210387477, -0.38562607747524646;
    -0.26510793650314357, -0.06101141037915056;
    -0.2166911256409305, 0.2936277030389234;
    -0.17163778725699363, 0.5001032788048433;
    -0.12971426393130348, 0.46892871631974203;
    -0.09070313021548704, 0.23599474025733994;
    -0.05440206501229761, -0.06599340050917354;];
    %-0.020622802289872733, -0.28155924173932534;
    %0.010809845311067323, -0.3114010335504721;
    %0.040058895040888054, -0.1567273031913436;
    %0.06727603948760463, 0.08999236215775161;
    %0.09260243329103082, 0.2986694730984528;];

sim_3 = [-1.0, -0.752;
    -0.9005308958112059, -0.49348787049895326;
    -0.8079718211848692, 0.014883984731192151;
    -0.7218427425573679, 0.4998840066724477;
    -0.6416969738667252, 0.7233701966367283;
    -0.5671188599315438, 0.5971888696254442;
    -0.49772162076352927, 0.21391569361136933;
    -0.43314534563369217, -0.21453942529081815;
    -0.373055126488974, -0.4721330338554553;
    -0.3171393210387477, -0.4460204113309108;
    -0.26510793650314357, -0.17354979535798018;
    -0.2166911256409305, 0.18915797627986236;
    -0.17163778725699363, 0.4547371900788816;
    -0.12971426393130348, 0.5000428491375821;
    -0.09070313021548704, 0.32159999612156204;
    -0.05440206501229761, 0.027024521650364196;];
    %-0.020622802289872733, -0.2278255937901101;
    %0.010809845311067323, -0.3201773699010727;
    %0.040058895040888054, -0.21828775525532948;
    %0.06727603948760463, 0.010673257705201972;
    %0.09260243329103082, 0.24239598944210308;];

sim_4 = [-1.07, -0.694;
    -0.9656680585179904, -0.36156485519036574;
    -0.8685839635490137, 0.149044283896238;
    -0.7782442136885115, 0.5696579462143525;
    -0.6941802853234582, 0.6997500302129807;
    -0.6159562027565162, 0.4999087262715663;
    -0.5431662771314898, 0.09748483134284609;
    -0.4754330024336028, -0.290820587257873;
    -0.4124050976527517, -0.4739485993160903;
    -0.35375568495592286, -0.37888054687561246;
    -0.2991805944203416, -0.07663452319995953;
    -0.24839678653528965, 0.26529716133735787;
    -0.201140884291308, 0.474187229477289;
    -0.15716780724384893, 0.4580519898902652;
    -0.1162495004673017, 0.24424866172755977;
    -0.07817375180744346, -0.044342411656902565;];
    %-0.042743091298303226, -0.25838500232769507;
    %-0.009773767035550274, -0.29830965086738725;
    %0.020905207804959414, -0.1593333130441376;
    %0.049452941745868284, 0.07433041281019036;
    %0.07601749018328219, 0.27883049577957286;];

sim_5 = [-1.07, -0.7469;
    -0.9656680585179904, -0.3415610453462442;
    -0.8685839635490137, 0.22577203243469118;
    -0.7782442136885115, 0.6602348052519769;
    -0.6941802853234582, 0.7581338038372074;
    -0.6159562027565162, 0.4999608086120861;
    -0.5431662771314898, 0.0441999727332663;
    -0.4754330024336028, -0.36646710195098375;
    -0.4124050976527517, -0.5325748487550857;
    -0.35375568495592286, -0.39292195373168204;
    -0.2991805944203416, -0.04297568081703315;
    -0.24839678653528965, 0.3258841690683896;
    -0.201140884291308, 0.5293843428836771;
    -0.15716780724384893, 0.4809915972855796;
    -0.1162495004673017, 0.22634830636286166;
    -0.07817375180744346, -0.09070410668947357;];
    %-0.042743091298303226, -0.3078018532571424;
    %-0.009773767035550274, -0.326049356918438;
    %0.020905207804959414, -0.15352595183745352;
    %0.049452941745868284, 0.10792190032263102;
    %0.07601749018328219, 0.3211815343746449;];

sim_6 = [-1.07, -0.562;
    -0.9656680585179904, -0.26941769698271567;
    -0.8685839635490137, 0.1591409152913488;
    -0.7782442136885115, 0.4997665741133102;
    -0.6941802853234582, 0.5913626794109665;
    -0.6159562027565162, 0.41000799827711004;
    -0.5431662771314898, 0.06899502942450778;
    -0.4754330024336028, -0.2490779611974006;
    -0.4124050976527517, -0.38868772964198206;
    -0.35375568495592286, -0.2960649406546202;
    -0.2991805944203416, -0.03706086136362688;
    -0.24839678653528965, 0.24575528783547596;
    -0.201140884291308, 0.41029421801637656;
    -0.15716780724384893, 0.38526248218963083;
    -0.1162495004673017, 0.19937096745809066;
    -0.07817375180744346, -0.04148889999149305;];
    %-0.042743091298303226, -0.2133214036134972;
    %-0.009773767035550274, -0.23698271928707515;
    %0.020905207804959414, -0.11350958095832872;
    %0.049452941745868284, 0.08329511621917557;
    %0.07601749018328219, 0.2496696028821266;];

sim_7 = [-1.0, -0.7502;
    -0.9005308958112059, -0.5008701523131589;
    -0.8079718211848692, 0.002765154700756639;
    -0.7218427425573679, 0.48943708172746136;
    -0.6416969738667252, 0.7196241982198852;
    -0.5671188599315438, 0.6014219330304124;
    -0.49772162076352927, 0.22334501826948897;
    -0.43314534563369217, -0.2050301187571193;
    -0.373055126488974, -0.4672592767080048;
    -0.3171393210387477, -0.4477965267033785;
    -0.26510793650314357, -0.1805239717504545;
    -0.2166911256409305, 0.180886477003939;
    -0.17163778725699363, 0.4493757591518993;
    -0.12971426393130348, 0.49999579732878285;
    -0.09070313021548704, 0.3264332193873432;
    -0.05440206501229761, 0.03392475196277914;];
    %-0.020622802289872733, -0.2224529931738033;
    %0.010809845311067323, -0.3188612254121938;
    %0.040058895040888054, -0.22133063727074068;
    %0.06727603948760463, 0.005153244998532869;
    %0.09260243329103082, 0.2373453503219561;];

sim_8 = [-1.0, -0.601;
    -0.9005308958112059, -0.3969821457065307;
    -0.8079718211848692, 0.013799723534312719;
    -0.7218427425573679, 0.4101460988610561;
    -0.6416969738667252, 0.5970437591094968;
    -0.5671188599315438, 0.4999750862196564;
    -0.49772162076352927, 0.19144544487620588;
    -0.43314534563369217, -0.15757281331224637;
    -0.373055126488974, -0.37077429957893;
    -0.3171393210387477, -0.3542793264845749;
    -0.26510793650314357, -0.13602528003080336;
    -0.2166911256409305, 0.1585515636116201;
    -0.17163778725699363, 0.3770189303844015;
    -0.12971426393130348, 0.4177507327679149;
    -0.09070313021548704, 0.2758756190722563;
    -0.05440206501229761, 0.03736151628875556;];
    %-0.020622802289872733, -0.17137085029765015;
    %0.010809845311067323, -0.24952842167740474;
    %0.040058895040888054, -0.16964895573342004;
    %0.06727603948760463, 0.01511221030487625;
    %0.09260243329103082, 0.20424132287327543;];

sim_9 = [-1.07, -0.4578;
    -0.9656680585179904, -0.2187662830061283;
    -0.8685839635490137, 0.1357719507282898;
    -0.7782442136885115, 0.42031950067197554;
    -0.6941802853234582, 0.5000032458586707;
    -0.6159562027565162, 0.3529992078840691;
    -0.5431662771314898, 0.07160895016560641;
    -0.4754330024336028, -0.19326729964294692;
    -0.4124050976527517, -0.3118942269387938;
    -0.35375568495592286, -0.23811979005923836;
    -0.2991805944203416, -0.025034044665187716;
    -0.24839678653528965, 0.20986068450522113;
    -0.201140884291308, 0.3483763783358177;
    -0.15716780724384893, 0.3302205570855167;
    -0.1162495004673017, 0.1778678252637651;
    -0.07817375180744346, -0.021692363504247723;];
    %-0.042743091298303226, -0.16558229559321055;
    %-0.009773767035550274, -0.18734461632691166;
    %0.020905207804959414, -0.08671483003012936;
    %0.049452941745868284, 0.07594487267947833;
    %0.07601749018328219, 0.21475274542669254;];

sim_10 = [-1.0, -0.4;
    -0.9005308958112059, -0.17852012495074557;
    -0.8079718211848692, 0.14004673677775054;
    -0.7218427425573679, 0.38960221642480247;
    -0.6416969738667252, 0.4525156494740834;
    -0.5671188599315438, 0.3136987538246744;
    -0.49772162076352927, 0.05925107253737742;
    -0.43314534563369217, -0.17488236495987955;
    -0.373055126488974, -0.2745159985335624;
    -0.3171393210387477, -0.20189127683774474;
    -0.26510793650314357, -0.007795275352883185;
    -0.2166911256409305, 0.2012081510328617;
    -0.17163778725699363, 0.32034538166851634;
    -0.12971426393130348, 0.29835886317386673;
    -0.09070313021548704, 0.1582818380103333;
    -0.05440206501229761, -0.020360962847133533;];
    %-0.020622802289872733, -0.14579310083287778;
    %0.010809845311067323, -0.1604851253358205;
    %0.040058895040888054, -0.06669337431392874;
    %0.06727603948760463, 0.07980297049922798;
    %0.09260243329103082, 0.20192826294322241;];

% plot all
for i = 1:size(reachSet,1)
    face_color = reachSet{i,2};
    edge_color = reachSet{i,3};
    poly_list = reachSet{i,5};

    for p_index = 1:size(poly_list,1)
        pts = poly_list{p_index};
        h = fill(pts(:,1), pts(:,2), face_color, 'EdgeColor', 'k', 'LineWidth', 1.5);
	plotnames(1) = h;
	legendnames{1} = 'Reachable set';

        reachSet{i,4} = h;  % add handle to reachSet data structure for use in legend
    end
end

plotnames(2) = plot(sim_2(:, 1), sim_2(:, 2), '-*', 'LineWidth', 2);
plotnames(3) = plot(sim_3(:, 1), sim_3(:, 2), '-*', 'LineWidth', 2);
%plotnames(4) = plot(sim_4(:, 1), sim_4(:, 2), '-*', 'LineWidth', 1.5);
plotnames(4) = plot(sim_5(:, 1), sim_5(:, 2), '-*', 'LineWidth', 2);
%plotnames(6) = plot(sim_6(:, 1), sim_6(:, 2), '-*', 'LineWidth', 1.5);
%plotnames(7) = plot(sim_7(:, 1), sim_7(:, 2), '-*', 'LineWidth', 1.5);
plotnames(5) = plot(sim_8(:, 1), sim_8(:, 2), '-*', 'LineWidth', 2);
%plotnames(6) = plot(sim_9(:, 1), sim_9(:, 2), '-*', 'LineWidth', 1.5);
plotnames(6) = plot(sim_10(:, 1), sim_10(:, 2), '-*', 'LineWidth', 2);

legendnames{2} = '11110';
legendnames{3} = '11101';
%legendnames{4} = '11100';
legendnames{4} = '11010';
%legendnames{6} = '11000';
%legendnames{7} = '01101';
legendnames{5} = '01100';
%legendnames{6} = '01000';
legendnames{6} = '00000';


legend(plotnames, legendnames);
set(legend, 'fontsize', 15);
xlim([-1.1 -0.05]);
ylim([-0.8 0.85]);
%legend(ca, 'Location', 'eastoutside');

% labels and such
xlabel('Z', 'FontSize', 24, 'FontName', 'Serif', 'Interpreter','LaTex');
ylabel('Y', 'FontSize', 24, 'FontName', 'Serif', 'Interpreter','LaTex');
%title('Damped Oscillator', 'FontSize', 32, 'FontName', 'Serif', 'Interpreter','LaTex');
hold off;
