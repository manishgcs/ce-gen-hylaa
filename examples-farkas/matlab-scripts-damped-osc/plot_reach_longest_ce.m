% Plot reachable region (Code generated by Hylaa using PLOT_MATLAB)
h = figure(1);
set(h, 'Position', [200 200 800 600]);
hold on;

% data
reachSet = [
    {'loc1', [0.6666666666666666 1.0 0.6666666666666666], [0.0 1.0 0.0], 0, {
    [-6.0, 0.0;-5.0, 0.0;-5.0, 1.0;-6.0, 1.0;-6.0, 0.0;]
    [-5.567257384975117, 1.1487425958523025;-4.606597419595954, 0.9540071956009012;-4.411862019344553, 1.9146671609800638;-5.372521984723716, 2.1094025612314655;-5.567257384975117, 1.1487425958523025;]
    [-4.927837989729241, 2.168023373181931;-4.042892306656773, 1.793874356958051;-3.668743290432893, 2.6788200400305193;-4.553688973505361, 3.052969056254399;-4.927837989729241, 2.168023373181931;]
    [-4.115083207110327, 3.0226881021691945;-3.3378114031098285, 2.4909278430725834;-2.8060511440132183, 3.268199647073083;-3.583322948013717, 3.7999599061696934;-4.115083207110327, 3.0226881021691945;]
    [-3.167868831401144, 3.6854580192814965;-2.524727490411092, 3.0232548901931597;-1.8625243613227558, 3.666396231183212;-2.505665702312807, 4.328599360271548;-3.167868831401144, 3.6854580192814965;]
    [-2.1288531742356205, 4.1376983367945215;-1.6399674381394824, 3.3763039206514938;-0.8785730219964548, 3.865189656747632;-1.3674587580925928, 4.62658407289066;-2.1288531742356205, 4.1376983367945215;]
    [-1.0426452453204045, 4.369814278550473;-0.7212627482767073, 3.543169807144689;0.1053817231290779, 3.8645523041883867;-0.21600077391461925, 4.691196775594172;-1.0426452453204045, 4.369814278550473;]
    [0.04603256237743447, 4.381275736417098;0.19379488675327405, 3.5245669389784355;1.0505036841919364, 3.672329263354275;0.9027413598160967, 4.529038060792938;0.04603256237743447, 4.381275736417098;]
    [1.069231375005961, 3.3285017641633905;1.9210117630069798, 3.3036195701242175;1.9458939570461526, 4.155399958125236;1.0941135690451336, 4.180282152164409;1.069231375005961, 3.3285017641633905;]
    [1.8720473254645258, 2.9696713481869246;2.685473190814917, 2.779896214054913;2.875248324946929, 3.5933220794053042;2.0618224595965375, 3.7830972135373164;1.8720473254645258, 2.9696713481869246;]
    [2.5734034420855947, 2.4686206413021936;3.3178731577166216, 2.127908450796114;3.658585348222701, 2.872378166427142;2.914115632591674, 3.2130903569332214;2.5734034420855947, 2.4686206413021936;]
    [3.1495958887866617, 1.8507024332934312;3.7984294098937967, 1.3784192617383468;4.2707125814488816, 2.0272527828454816;3.621879060341746, 2.4995359544005664;3.1495958887866617, 1.8507024332934312;]
    [3.5827903980944917, 1.14488810904512;4.114128533017249, 0.5648337062605151;4.694182935801854, 1.096171841183272;4.162844800879097, 1.6762262439678768;3.5827903980944917, 1.14488810904512;]
    [3.861495938502551, 0.3824822159797936;4.258974080052167, -0.2782231747579058;4.919679470789866, 0.11925496679170977;4.52220132924025, 0.7799603575294094;3.861495938502551, 0.3824822159797936;]
    }}
];

simulation_1 = [-6.0, 0.4890713139;
-5.472017886911322,1.618573827331418;
-4.744852438770236, 2.600824921132316;
-3.8550145185141433, 3.402829444609142;
-2.8440042769892195, 3.999999999942909;
-1.7564770067364264, 4.376798326094028;
-0.6383571475618062, 4.526993238644097;
0.46502425957045, 4.453542050544509;
1.5106949225590438, 4.168112984832956;
2.459645716323698, 3.690283639341825;
3.2782144145740997, 3.046457798260666;
3.939204923011976, 2.2685558031552615;
4.422707040650945, 1.3925382750645303;
4.716596486174451, 0.45682830398050966;];

% plot all
for i = 1:size(reachSet,1)
    face_color = reachSet{i,2};
    edge_color = reachSet{i,3};
    poly_list = reachSet{i,5};

    for p_index = 1:size(poly_list,1)
        pts = poly_list{p_index};
        h = fill(pts(:,1), pts(:,2), face_color, 'EdgeColor', 'k', 'LineWidth', 1.5);
	plotnames(1) = h;
	legendnames{1} = 'Reachable set';

        reachSet{i,4} = h;  % add handle to reachSet data structure for use in legend
    end
end

% optional legend
%if (size(reachSet,1) > 1 && size(reachSet,1) < 10)
%    legend([reachSet{:,3}], reachSet{:,1})
%end

plotnames(2) = plot(simulation_1(:, 1), simulation_1(:, 2), 'm-*', 'LineWidth', 2);

legendnames{2} = 'Longest counterexample';

legend(plotnames, legendnames);
set(legend, 'fontsize', 15);
xlim([-6 5]);
ylim([-0.5 5]);
%legend(ca, 'Location', 'eastoutside');

% labels and such
xlabel('X', 'FontSize', 24, 'FontName', 'Serif', 'Interpreter','LaTex');
ylabel('Y', 'FontSize', 24, 'FontName', 'Serif', 'Interpreter','LaTex');
%title('Damped Oscillator', 'FontSize', 32, 'FontName', 'Serif', 'Interpreter','LaTex');
hold off;
