% Plot reachable region (Code generated by Hylaa using PLOT_MATLAB)
h = figure(1);
set(h, 'Position', [200 200 800 600]);
hold on;

% data
reachSet = [
    {'loc1', [0.6666666666666666 1.0 0.6666666666666666], [0.0 1.0 0.0], 0, {
    [-6.0, 0.0;-5.0, 0.0;-5.0, 1.0;-6.0, 1.0;-6.0, 0.0;]
    [-5.567257384975117, 1.1487425958523025;-4.606597419595954, 0.9540071956009012;-4.411862019344553, 1.9146671609800638;-5.372521984723716, 2.1094025612314655;-5.567257384975117, 1.1487425958523025;]
    [-4.927837989729241, 2.168023373181931;-4.042892306656773, 1.793874356958051;-3.668743290432893, 2.6788200400305193;-4.553688973505361, 3.052969056254399;-4.927837989729241, 2.168023373181931;]
    [-4.115083207110327, 3.0226881021691945;-3.3378114031098285, 2.4909278430725834;-2.8060511440132183, 3.268199647073083;-3.583322948013717, 3.7999599061696934;-4.115083207110327, 3.0226881021691945;]
    [-3.167868831401144, 3.6854580192814965;-2.524727490411092, 3.0232548901931597;-1.8625243613227558, 3.666396231183212;-2.505665702312807, 4.328599360271548;-3.167868831401144, 3.6854580192814965;]
    [-2.1288531742356205, 4.1376983367945215;-1.6399674381394824, 3.3763039206514938;-0.8785730219964548, 3.865189656747632;-1.3674587580925928, 4.62658407289066;-2.1288531742356205, 4.1376983367945215;]
    [-1.0426452453204045, 4.369814278550473;-0.7212627482767073, 3.543169807144689;0.1053817231290779, 3.8645523041883867;-0.21600077391461925, 4.691196775594172;-1.0426452453204045, 4.369814278550473;]
    [0.04603256237743447, 4.381275736417098;0.19379488675327405, 3.5245669389784355;1.0505036841919364, 3.672329263354275;0.9027413598160967, 4.529038060792938;0.04603256237743447, 4.381275736417098;]
    [1.069231375005961, 3.3285017641633905;1.9210117630069798, 3.3036195701242175;1.9458939570461526, 4.155399958125236;1.0941135690451336, 4.180282152164409;1.069231375005961, 3.3285017641633905;]
    [1.8720473254645258, 2.9696713481869246;2.685473190814917, 2.779896214054913;2.875248324946929, 3.5933220794053042;2.0618224595965375, 3.7830972135373164;1.8720473254645258, 2.9696713481869246;]
    [2.5734034420855947, 2.4686206413021936;3.3178731577166216, 2.127908450796114;3.658585348222701, 2.872378166427142;2.914115632591674, 3.2130903569332214;2.5734034420855947, 2.4686206413021936;]
    [3.1495958887866617, 1.8507024332934312;3.7984294098937967, 1.3784192617383468;4.2707125814488816, 2.0272527828454816;3.621879060341746, 2.4995359544005664;3.1495958887866617, 1.8507024332934312;]
    [3.5827903980944917, 1.14488810904512;4.114128533017249, 0.5648337062605151;4.694182935801854, 1.096171841183272;4.162844800879097, 1.6762262439678768;3.5827903980944917, 1.14488810904512;]
    [3.861495938502551, 0.3824822159797936;4.258974080052167, -0.2782231747579058;4.919679470789866, 0.11925496679170977;4.52220132924025, 0.7799603575294094;3.861495938502551, 0.3824822159797936;]
    }}
];

simulation_1 = [-6.0, 0.4890713139;
-5.472017886911322,1.618573827331418;
-4.744852438770236, 2.600824921132316;
-3.8550145185141433, 3.402829444609142;
-2.8440042769892195, 3.999999999942909;
-1.7564770067364264, 4.376798326094028;
-0.6383571475618062, 4.526993238644097;
0.46502425957045, 4.453542050544509;
1.5106949225590438, 4.168112984832956;
2.459645716323698, 3.690283639341825;
3.2782144145740997, 3.046457798260666;
3.939204923011976, 2.2685558031552615;
4.422707040650945, 1.3925382750645303;
4.716596486174451, 0.45682830398050966;];

simulation_2 = [-5.6560875164, 0.8431768708;
-5.072678044968518, 1.8917769242182418;
-4.3080203253001415, 2.785514587656892;
-3.3994017792833864, 3.495186718241712;
-2.388330133296749, 3.9999999998871436;
-1.3187291052901124, 4.288062437279898;
-0.23511029391248717, 4.356503213522297;
0.8192069133472005, 4.211232660457354;
1.8037577940592138, 3.8663641529366197;
2.6824182976656, 3.343335900207104;
3.4246601021930676, 2.669777289431239;
4.006536399847013, 1.8781757599903626;
4.4113688765352075, 1.0044039701215137;
4.630120872986945, 0.0861711588094638;];

simulation_3 = [-5.8191497942, 0.0;
-5.393521832532475, 1.1135246586402914;
-4.767795380823764, 2.100358446597975;
-3.9745134413943006, 2.926519149875311;
-3.051556587524605, 3.565698447104467;
-2.0404380882499495, 3.999999999940084;
-0.9845231545895341, 4.2203154557733065;
0.07275540915029133, 4.226339774089646;
1.0896136191323937, 4.026237493698021;
2.027501587533041, 3.6359889783856554;
2.852497762820081, 3.078452855649483;
3.5364665515701326, 2.3821942785784023;
4.057941842760306, 1.5801336329177085;
4.402712623352168, 0.7080763538291601;];

simulation_4 = [-5.808384589413996, 0.6863503821890522;
-5.249523414887165, 1.7707776265692103;
-4.50147143904008, 2.703713463611183;
-3.60117209418594, 3.454275441529594;
-2.5901296685459356, 3.9999900000000004;
-1.5125917846675412, 4.327350344943746;
-0.4136956573103936, 4.431997458428217;
0.6623485113786025, 4.318533856251747;
1.6739655520636756, 3.9999900000000004;
2.58375377291652, 3.496980046525441;
3.3597970001677253, 2.836590544533419;
3.976709461700309, 2.0510577175533697;
4.416381570303158, 1.1762931080429957;
4.668409268882033, 0.2503220227902305;];

simulation_5 = [-5.3174890132, 0.7812903695;
-4.759451511207783, 1.7663879249767689;
-4.0315338151774345, 2.60406209862384;
-3.169127491835124, 3.2670308579416245;
-2.211544872700666, 3.735977244128212;
-1.2003131633365784, 3.999999999886565;
-0.17744879561310478, 4.056713394504651;
0.8162203051038035, 3.9120078506867744;
1.7426190123118783, 3.5794924604381118;
2.5678206404304604, 3.0796556388204657;
3.2632228384415054, 2.4387864434615243;
3.8064679883244312, 1.6877096540279133;
4.182080665800133, 0.8603912104955889;
4.381808485103257, -0.007525599951147877;];

simulation_6 = [-5.7883466739, 0.0;
-5.363930508051506, 1.1075262006796787;
-4.740536292489116, 2.088833489441104;
-3.950571044509874, 2.9101392746435986;
-3.031745827428185, 3.545300524456122;
-2.025378882108026, 3.9765466761438817;
-0.9746235708707824, 4.194852226675263;
0.07730694980384811, 4.199950469940074;
1.088847169916077, 3.999999999937245;
2.0216559212464236, 3.610932923600135;
2.8420027642282455, 3.0555208654391923;
3.5219187562210554, 2.3622081815730667;
4.040074357210786, 1.5637667604277046;
4.382360835718416, 0.6958327868183865;];

simulation_7 = [-5.789675278469988, 0.04588338357831663;
-5.356271726205701, 1.1518632567022156;
-4.724544812540988, 2.129934887756305;
-3.927204771440958, 2.946509634081538;
-3.002216187774251, 3.5756898314034093;
-1.9910930658809263, 3.99999;
-0.9371213157606626, 4.210696626684943;
0.11641933047220665, 4.20786853257126;
1.1279627947799271, 3.9999900000000004;
2.0592307883492977, 3.6033061196491802;
2.8766142255263416, 3.0408769431787994;
3.552316911128541, 2.3414002748363254;
4.065224611595616, 1.5378578400427148;
4.401476293952683, 0.6660454792182404;];

simulation_8 =  [-5.552632006, 0.0
-5.137488863347331, 1.061624210481046;
-4.531941614694151, 2.00064107833678;
-3.767356679361863, 2.784795581768223;
-2.880147979823954, 3.389209533800724;
-1.9101413431830778, 3.797074844201813;
-0.8988690023112547, 3.999999999626477;
0.11213669702223117, 3.998011640264811;
1.0829820718115102, 3.7992228686558516;
1.9769231385288184, 3.419196515887797;
2.7616919033936234, 2.8800384336576177;
3.41059468528319, 2.2092686036229106;
3.9033470262944796, 1.4385225684117815;
4.22662288396094, 0.6021413586855096;];


simulation_9 = [-5.0, 0.0;
-4.606597419595954, 0.9540071956009012;
-4.042892306656773, 1.793874356958051;
-3.3378114031098285, 2.4909278430725834;
-2.524727490411092, 3.0232548901931597;
-1.6399674381394824, 3.3763039206514938;
-0.7212627482767073, 3.543169807144689;
0.19379488675327405, 3.5245669389784355;
1.069231375005961, 3.3285017641633905;
1.8720473254645258, 2.9696713481869246;
2.5734034420855947, 2.4686206413021936;
3.1495958887866617, 1.8507024332934312;
3.5827903980944917, 1.14488810904512;
3.861495938502551, 0.3824822159797936;];

usafe_rectangle = [-6.0,4.0;6.0,4.0;6.0,5.0;-6.0,5.0;-6.0,4.0;]

% plot all
for i = 1:size(reachSet,1)
    face_color = reachSet{i,2};
    edge_color = reachSet{i,3};
    poly_list = reachSet{i,5};

    for p_index = 1:size(poly_list,1)
        pts = poly_list{p_index};
        h = fill(pts(:,1), pts(:,2), face_color, 'EdgeColor', edge_color);

        reachSet{i,4} = h;  % add handle to reachSet data structure for use in legend
    end
end

% optional legend
if (size(reachSet,1) > 1 && size(reachSet,1) < 10)
    legend([reachSet{:,3}], reachSet{:,1})
end

plotnames(1) = plot(simulation_1(:, 1), simulation_1(:, 2), '-*', 'LineWidth', 1.5);
plotnames(2) = plot(simulation_2(:, 1), simulation_2(:, 2), '-*', 'LineWidth', 1.5);
plotnames(3) = plot(simulation_3(:, 1), simulation_3(:, 2), '-*', 'LineWidth', 1.5);
plotnames(4) = plot(simulation_4(:, 1), simulation_4(:, 2), '-*', 'LineWidth', 1.5);
plotnames(5) = plot(simulation_5(:, 1), simulation_5(:, 2), '-*', 'LineWidth', 1.5);
plotnames(6) = plot(simulation_6(:, 1), simulation_6(:, 2), '-*', 'LineWidth', 1.5);
plotnames(7) = plot(simulation_7(:, 1), simulation_7(:, 2), '-*', 'LineWidth', 1.5);
plotnames(8) = plot(simulation_8(:, 1), simulation_8(:, 2), '-*', 'LineWidth', 1.5);
plotnames(9) = plot(simulation_9(:, 1), simulation_9(:, 2), '-*', 'LineWidth', 1.5);
%plotnames(10) = plot(usafe_rectangle(:,1), usafe_rectangle(:,2), 'LineWidth', 2, 'LineStyle', '-.');

legendnames{1} = '11111';
legendnames{2} = '11110';
legendnames{3} = '01111';
legendnames{4} = '01110';
legendnames{5} = '01100';
legendnames{6} = '00111';
legendnames{7} = '00110';
legendnames{8} = '00100';
legendnames{9} = '00000';
%legendnames{10} = 'Unsafe set';


legend(plotnames, legendnames);

% labels and such
xlabel('X', 'FontSize', 24, 'FontName', 'Serif', 'Interpreter','LaTex');
ylabel('Y', 'FontSize', 24, 'FontName', 'Serif', 'Interpreter','LaTex');
title('Damped Oscillator', 'FontSize', 32, 'FontName', 'Serif', 'Interpreter','LaTex');
hold off;
